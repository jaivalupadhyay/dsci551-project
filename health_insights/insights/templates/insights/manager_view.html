<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Manager View</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@0.7.0"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/chartjs-chart-radial-gauge"></script>

      <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
        google.charts.load('current', {'packages':['gauge']});
        google.charts.setOnLoadCallback(drawChart);

        function drawChart() {
            var data = google.visualization.arrayToDataTable([
                ['Label', 'Value'],
                ['Sleep', {{ average_sleep|floatformat:2 }}],
            ]);

        var options = {
        width: 220, height: 220,
        greenFrom: 6, greenTo: 8.5,  // Adequate sleep
        yellowFrom: 4, yellowTo: 6, // Slightly less than adequate
        redFrom: 0, redTo: 4,       // Insufficient sleep
        blackFrom: 8.5, blackTo: 11,// Excessive sleep, use orange to distinguish from insufficient sleep
        minorTicks: 5,
        max: 11                      // Extend the max to 11 to include the excessive sleep range
    };


            var chart = new google.visualization.Gauge(document.getElementById('gauge_div'));
            chart.draw(data, options);
        }
    </script>




  <style>
          .charts-container {
            display: flex;
            justify-content: space-around; /* Or 'space-between' depending on the exact spacing you want */
            align-items: center; /* If you want to vertically center your charts */
            padding: 20px;
        }

        .chart {
            flex-basis: calc(50% - 20px); /* Adjust the 20px if you have a different gap between items */
            text-align: center; /* Center the title and the chart itself */
        }
      /* Add any additional styling you wish here */
    .chart-container {
      position: relative;
      height: 40vh;
      width: 40vw;
    }

    body {
      background-color: #f7f7f7;
    }
    .table-custom {
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
      background-color: #ffffff;
      border-radius: 8px;
      overflow: hidden;
    }
    .table-custom thead {
      background-color: #007bff;
      color: #ffffff;
    }
    .table-custom thead th {
      border: none;
    }
    .table-custom tbody tr:hover {
      background-color: #f2f2f2;
    }
    .table-custom tbody td {
      border-color: #e9ecef;
    }
    .container {
      padding-top: 30px;
    }

      #dbCountChart {
        padding: 0px;
        width: 100px;
    }
    .chart-container {
    padding: 0px;
   }

   <style>
    .navbar-custom {
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .navbar-center {
        flex-grow: 1;
        text-align: center;
    }

    .navbar-center h3 {
        color: white;  <!-- Sets the text color to white -->
    }

  </style>





  </head>
  <body>
<!--  nav start-->
<nav class="navbar bg-dark navbar-expand-lg bg-body-tertiary" data-bs-theme="dark">
    <div class="container-fluid justify-content-between">
        <a class="navbar-brand" href="{% url 'home' %}">Health Insights</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="d-flex justify-content-center flex-grow-1">
            <h3 class="text-center text-white">Manager View</h3>  <!-- Added text-white here -->
        </div>
    </div>
</nav>

<!--nav end-->
<!--sleep gauge-->
    <h2>Sleep Hours Gauge</h2>
    <div id="gauge_div" style="width: 400px; height: 400px;"></div>
<!--sleep guage end-->

<!--count graph start-->
    <div class="chart-container px-4" style="width:350px">
        <canvas id="dbCountChart"></canvas>
    </div>

<!--count graph end-->

<br>

<br>

<div class="container mt-4">
    <div class="row">
        <div class="col-md-3 mb-4">
            <div class="card" style="width: 100%;">
                <img src="https://www.simplilearn.com/ice9/free_resources_article_thumb/What_is_Data_Types_of_Data_and_How_To_Analyze_Data.jpg" class="card-img-top" alt="Data Analysis">
                <div class="card-body">
                    <h5 class="card-title">Click here to add user</h5>
                    <a href="{% url 'add' %}" class="btn btn-primary" role="button">Add a User</a>
                </div>
            </div>
        </div>
        <div class="col-md-3 mb-4">
            <div class="card" style="width: 100%;">
                <img src="https://www.simplilearn.com/ice9/free_resources_article_thumb/What_is_Data_Types_of_Data_and_How_To_Analyze_Data.jpg" class="card-img-top" alt="Data Management">
                <div class="card-body">
                    <h5 class="card-title">Click here to update a user</h5>
                    <a href="{% url 'update' %}" class="btn btn-primary" role="button">Update</a>
                </div>
            </div>
        </div>
        <div class="col-md-3 mb-4">
            <div class="card" style="width: 100%;">
                <img src="https://www.simplilearn.com/ice9/free_resources_article_thumb/What_is_Data_Types_of_Data_and_How_To_Analyze_Data.jpg" class="card-img-top" alt="Data Storage">
                <div class="card-body">
                    <h5 class="card-title">Click here to Delete a user</h5>
                    <a href="{% url 'delete' %}" class="btn btn-primary" role="button">Delete</a>
                </div>
            </div>
        </div>
        <div class="col-md-3 mb-4">
            <div class="card" style="width: 100%;">
                <img src="https://www.simplilearn.com/ice9/free_resources_article_thumb/What_is_Data_Types_of_Data_and_How_To_Analyze_Data.jpg" class="card-img-top" alt="Data Security">
                <div class="card-body">
                    <h5 class="card-title">Click here to see stats</h5>
                    <a href="" class="btn btn-primary" role="button" id="statsbutton">Stats</a>
                </div>
            </div>
        </div>
    </div>
</div>






    <div class="container mt-4" id="stats" style="display: none;">
  <h2>Patient Statistics</h2>

<!--        doughnut graph-->
        <div class="chart-container">
  <canvas id="bmiDoughnutChart"></canvas>
</div>


<!--        graph end-->

<!--        table start-->

  <table class="table table-striped">
    <thead>
      <tr>
        <th scope="col">Category</th>
        <th scope="col">Count</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Total Count of Patients</td>
        <td>{{ count }}</td>
      </tr>
      <tr>
        <td>Total Count of Males</td>
        <td>{{ male_count }}</td>
      </tr>
      <tr>
        <td>Total Count of Females</td>
        <td>{{ female_count }}</td>
      </tr>
      <tr>
        <td>Underweight</td>
        <td>{{ underweight_count }}</td>
      </tr>
      <tr>
        <td>Normal Weight</td>
        <td>{{ idealweight_count }}</td>
      </tr>
      <tr>
        <td>Overweight</td>
        <td>{{ overweight_count }}</td>
      </tr>
      <tr>
        <td>Obese Class I</td>
        <td>{{ obese_class1_count }}</td>
      </tr>
      <tr>
        <td>Obese Class II</td>
        <td>{{ obese_class2_count }}</td>
      </tr>
      <tr>
        <td>Obese Class III</td>
        <td>{{ obese_class3_count }}</td>
      </tr>
    </tbody>
  </table>
</div>
<!--    table end-->

    <div class="text-center">
    <h2>Graphical Analysis</h2>
</div>

<!-- Flex container -->
<div class="d-flex justify-content-center p-4">
    <form method="post" action="{% url 'manager_graphs' %}" class="w-75">
        {% csrf_token %}
        <div class="row"> <!-- Ensures that all elements are on the same line -->
            <div class="col-md-6">
                <div class="form-group">
                    <label for="x-axis-select">X - axis</label>
                    <select name="xaxis" id="x-axis-select" class="form-control" required>
                        <option value="">Select an option for X-axis</option>
                        <option value="age">Age</option>
                        <option value="gender">Gender</option>
                        <option value="height">Height</option>
                        <option value="weight">Weight</option>
                        <option value="blood_type">Blood Type</option>
                        <option value="blood_pressure">Blood Pressure</option>
                        <option value="oxygen_level">Oxygen Level</option>
                        <option value="heart_rate">Heart Rate</option>
                        <option value="blood_sugar">Blood Sugar</option>
                        <option value="cholesterol">Cholesterol</option>
                        <option value="body_temperature">Body Temperature</option>
                        <option value="bmi">BMI</option>
                        <option value="sleep_hours">Sleep Hours</option>
                        <option value="stress_level">Stress Level</option>
                    </select>
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group">
                    <label for="y-axis-select">Y - axis</label>
                    <select name="yaxis" id="y-axis-select" class="form-control" required>
                        <option value="">Select an option for Y-axis</option>
                        <option value="age">Age</option>
                        <option value="gender">Gender</option>
                        <option value="height">Height</option>
                        <option value="weight">Weight</option>
                        <option value="blood_type">Blood Type</option>
                        <option value="blood_pressure">Blood Pressure</option>
                        <option value="oxygen_level">Oxygen Level</option>
                        <option value="heart_rate">Heart Rate</option>
                        <option value="blood_sugar">Blood Sugar</option>
                        <option value="cholesterol">Cholesterol</option>
                        <option value="body_temperature">Body Temperature</option>
                        <option value="bmi">BMI</option>
                        <option value="sleep_hours">Sleep Hours</option>
                        <option value="stress_level">Stress Level</option>
                    </select>
                </div>
            </div>
        </div>
        <br>
        <div class="form-group">
            <button type="submit" class="btn btn-primary form-control">Create graph</button> <!-- Button width is set to the full width of the form -->
        </div>
    </form>
</div>






    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
  </body>

<script>
<!--count graph-->
document.addEventListener('DOMContentLoaded', function () {
    const ctx = document.getElementById('dbCountChart').getContext('2d');
    const dbCountChart = new Chart(ctx, {
        type: 'doughnut',
        data: {
            labels: ['Database 1', 'Database 2'],
            datasets: [{
                data: [{{ db1_count }}, {{ db2_count }}],
                 backgroundColor: [
                    '#FF8000',  // Orange
                    '#0000FF'   // Blue
                ],
                borderColor: [
                    '#FF8000',  // Orange border
                    '#0000FF'   // Blue border
                ],
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            cutoutPercentage: 70,
            plugins: {
                datalabels: {
                    color: '#000',
                    textAlign: 'center',
                    font: {
                        weight: 'bold',
                        size: 13
                    },
                    formatter: (value, ctx) => {
                        return ctx.chart.data.labels[ctx.dataIndex] + '\n' + value;
                    }
                },
                tooltip: {
                    callbacks: {
                        label: function(tooltipItem) {
                            return `${tooltipItem.label}: ${tooltipItem.raw}`;
                        }
                    }
                }
            }
        },
        plugins: [ChartDataLabels]
    });
});
<!--table-->
  document.addEventListener('DOMContentLoaded', function() {
    const ctx = document.getElementById('bmiDoughnutChart').getContext('2d');
    const bmiDoughnutChart = new Chart(ctx, {
      type: 'doughnut',
      data: {
        labels: [
          'Underweight',
          'Normal Weight',
          'Overweight',
          'Obese Class I',
          'Obese Class II',
          'Obese Class III'
        ],
        datasets: [{
          data: [/* Replace with your data */ {{underweight_count}}, {{idealweight_count}}, {{overweight_count}}, {{obese_class1_count}}, {{obese_class2_count}}, {{obese_class3_count}}],
          backgroundColor: [
            '#f8c291',
            '#6a89cc',
            '#82ccdd',
            '#f6b93b',
            '#e55039',
            '#4a69bd'
          ],
          hoverBackgroundColor: [
            '#f6d365',
            '#7d5fff',
            '#4bcffa',
            '#fbc7d4',
            '#ff6b81',
            '#34e7e4'
          ],
          borderColor: '#fff',
          borderWidth: 2
        }]
      },
      options: {
        responsive: true,
        legend: {
          position: 'bottom',
        },
        tooltips: {
          enabled: true
        },
        animation: {
          animateScale: true,
          animateRotate: true
        },
        onClick: function(event, elements) {
          if (elements.length > 0) {
            var index = elements[0]._index;
            var label = this.data.labels[index];
            var value = this.data.datasets[0].data[index];
            alert(`You clicked on: ${label} (Value: ${value})`);
          }
        }
      }
    });
  });

<!--stats-->
    document.getElementById('statsbutton').addEventListener('click', function(event) {
    // Prevent the default form submission which causes a page reload
    event.preventDefault();

    var div = document.getElementById('stats');
    div.style.display = div.style.display === 'none' ? 'block' : 'none';
  });
</script>

</html>