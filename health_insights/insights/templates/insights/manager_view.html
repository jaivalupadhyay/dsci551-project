<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Manager View</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@0.7.0"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/chartjs-chart-radial-gauge"></script>
       <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>


      <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
        google.charts.load('current', {'packages':['gauge']});
        google.charts.setOnLoadCallback(drawChart);

        function drawChart() {
            var data = google.visualization.arrayToDataTable([
                ['Label', 'Value'],
                ['Sleep', {{ average_sleep|floatformat:2 }}],
            ]);

        var options = {
        width: 200, height: 200,
        greenFrom: 6, greenTo: 8.5,  // Adequate sleep
        yellowFrom: 4, yellowTo: 6, // Slightly less than adequate
        redFrom: 0, redTo: 4,       // Insufficient sleep
        blackFrom: 8.5, blackTo: 11,// Excessive sleep, use orange to distinguish from insufficient sleep
        minorTicks: 5,
        max: 11                      // Extend the max to 11 to include the excessive sleep range
    };


            var chart = new google.visualization.Gauge(document.getElementById('gauge_div'));
            chart.draw(data, options);
        }
    </script>

<!--      sleep gauge scrript end-->

<!--      stress gauge script start-->
<script type="text/javascript">
        google.charts.load('current', {'packages':['gauge']});
        google.charts.setOnLoadCallback(drawChart);

        function drawChart() {
            var data = google.visualization.arrayToDataTable([
                ['Label', 'Value'],
                ['Stress', {{ average_stress|floatformat:2 }}], // Ensure your context variable is correctly referenced
            ]);

            var options = {
                width: 200, height: 200,
                redFrom: 0.7, redTo: 1,
                yellowFrom: 0.4, yellowTo: 0.7,
                greenFrom: 0, greenTo: 0.4,
                minorTicks: 10,
                max: 1
            };

            var chart = new google.visualization.Gauge(document.getElementById('stress_gauge_div'));
            chart.draw(data, options);
        }
    </script>
<!--      stress gauge script end -->

<!--w and h script start-->
      <script type="text/javascript">
        google.charts.load('current', {'packages':['gauge']});
        google.charts.setOnLoadCallback(drawCharts);

        function drawCharts() {
            // Prepare data for the Weight Gauge
            var weightData = google.visualization.arrayToDataTable([
                ['Label', 'Value'],
                ['Cholesterol', {{ average_weight|floatformat:2 }}],
            ]);

            // Prepare data for the Height Gauge
            var heightData = google.visualization.arrayToDataTable([
                ['Label', 'Value'],
                ['O2 Level', {{ average_height|floatformat:2 }}],
            ]);

            // Options for the Cholesterol Gauge
            var weightOptions = {
                width: 200, height: 200,
                greenFrom: 0, greenTo: 200,  // Example values, adjust as needed
                yellowFrom: 200, yellowTo: 240,
                redFrom: 240, redTo: 300,     // Example values, adjust as needed
                minorTicks: 5,
                max: 300
            };

            // Options for the O2 Gauge
            var heightOptions = {
                width: 200, height: 200,
                greenFrom: 92, greenTo: 100,
                yellowFrom: 80, yellowTo: 92,
                redFrom: 0, redTo: 80,     // Example values, adjust as needed
                minorTicks: 5,
                max: 100
            };

            // Draw the Weight Gauge
            var weightChart = new google.visualization.Gauge(document.getElementById('weight_gauge_div'));
            weightChart.draw(weightData, weightOptions);

            // Draw the Height Gauge
            var heightChart = new google.visualization.Gauge(document.getElementById('height_gauge_div'));
            heightChart.draw(heightData, heightOptions);
        }
    </script>
<!--      w and h script end-->



  <style>
          .charts-container {
            display: flex;
            justify-content: space-around; /* Or 'space-between' depending on the exact spacing you want */
            align-items: center; /* If you want to vertically center your charts */
            padding: 20px;
        }

        .chart {
            flex-basis: calc(50% - 20px); /* Adjust the 20px if you have a different gap between items */
            text-align: center; /* Center the title and the chart itself */
        }
      /* Add any additional styling you wish here */
    .chart-container {
      position: relative;
      height: 40vh;
      width: 40vw;
    }

    body {
      background-color: #f7f7f7;
    }
    .table-custom {
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
      background-color: #ffffff;
      border-radius: 8px;
      overflow: hidden;
    }
    .table-custom thead {
      background-color: #007bff;
      color: #ffffff;
    }
    .table-custom thead th {
      border: none;
    }
    .table-custom tbody tr:hover {
      background-color: #f2f2f2;
    }
    .table-custom tbody td {
      border-color: #e9ecef;
    }
    .container {
      padding-top: 30px;
    }

      #dbCountChart {
        padding: 0px;
        width: 100px;
    }
    .chart-container {
    padding: 0px;
   }


    .navbar-custom {
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .navbar-center {
        flex-grow: 1;
        text-align: center;
    }

    .navbar-center h3 {
        color: white;  <!-- Sets the text color to white -->
    }
    {% comment %} .row {
      height: 60vh;
    } {% endcomment %}

    .chart-title{
      text-align: center;
    }

    .gauge_div {
      align-items: center;
    }

    .flex-div{
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .my-card{
      height: 100%;
    }


  </style>

<style>
        body {
            background-color: #f4f4f8; /* Slightly off-white background for a light and airy feel */
            font-family: 'Helvetica Neue', Arial, sans-serif; /* Modern font */
        }
        .feature-container {
            background: linear-gradient(145deg, #ffffff, #e6e7ee);
            border: none;
            border-radius: 12px; /* Smoothly rounded borders for a soft, modern look */
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1); /* Deeper shadow for more depth */
            transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out; /* Smooth transitions for interactive hover effect */
        }
        .feature-container:hover {
            transform: translateY(-10px); /* Raise the container slightly on hover */
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.2); /* Increase shadow size on hover for a "lifting" effect */
        }
        .feature-icon {
            font-size: 60px; /* Increased icon size for better visibility */
            color: #1064ea; /* A vibrant blue that stands out */
            margin-bottom: 15px; /* Space between icon and text */
        }
        .feature-text {
            font-size: 20px; /* Slightly larger text for better readability */
            font-weight: 500; /* Medium font weight for clarity */
            color: #333; /* Dark grey text for high contrast */
        }
        .btn-custom {
            background-color: #1064ea; /* Custom button color that matches the icon color */
            border: none; /* No border for a cleaner look */
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* Subtle shadow for depth */
            transition: background-color 0.2s; /* Smooth transition for hover effects */
        }
        .btn-custom:hover, .btn-custom:focus {
            background-color: #0d58d1; /* Slightly darker blue on hover/focus for interactive feedback */
            outline: none; /* Remove outline to maintain clean aesthetics */
        }
    </style>

<!--graphical anysis-->


  </head>
  <body>
<!--  nav start-->



<nav class="navbar bg-dark navbar-expand-lg bg-body-tertiary" data-bs-theme="dark">
    <div class="container-fluid justify-content-between">
        <a class="navbar-brand" href="{% url 'home' %}">Health Insights</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="d-flex justify-content-center flex-grow-1">
            <h3 class="text-center text-white">Manager View</h3>  <!-- Added text-white here -->
        </div>
    </div>
</nav>

<!--nav end-->


<div class="container">
  <div class="row">

    <!-- Database Count Graph -->
    <div class="col-md-6">
      <div class="chart-container" style="width: 100%; height: 100%; margin: auto;">
        <canvas id="dbCountChart"></canvas>
      </div>
    </div>

    <!-- Gauges on the Right in 2x2 Grid -->
    <div class="col-md-6">
      <div class="row" style="height: 60vh;">

        <!-- Sleep Hours Gauge -->
        <div class="col-md-6 flex-div">
          <div class="gauge-chart">
            <h2 class="chart-title">Sleep Hours</h2>
            <div id="gauge_div" style="width: 100%; height: 150px;"></div>
          </div>
        </div>

        <!-- Stress Level Gauge -->
        <div class="col-md-6 flex-div">
          <div class="gauge-chart">
            <h2 class="chart-title">Stress Level</h2>
            <div id="stress_gauge_div" style="width: 100%; height: 150px;"></div>
          </div>
        </div>

        <!-- Cholesterol Gauge -->
        <div class="col-md-6 flex-div">
          <div class="gauge-chart">
            <h2 class="chart-title">Cholesterol</h2>
            <div id="weight_gauge_div" style="width: 100%; height: 150px;"></div>
          </div>
        </div>

        <!-- O2 Level Gauge -->
        <div class="col-md-6 flex-div">
          <div class="gauge-chart">
            <h2 class="chart-title">O2 Level</h2>
            <div id="height_gauge_div" style="width: 100%; height: 150px;"></div>
          </div>
        </div>

      </div> <!-- End of Inner Row for Gauges -->
    </div> <!-- End of Column for Right Side Gauges -->

  </div> <!-- End of Main Row -->
</div> <!-- End of Container -->



<br>

<br>

<div class="container py-5">
  <div class="row g-4">
      <div class="col-lg-3 col-md-6">
          <a href="{% url 'add' %}" class="text-decoration-none">
              <div class="feature-container text-center p-4">
                  <i class="fas fa-user-plus feature-icon"></i>
                  <div class="feature-text">Add User</div>
                  <div class="btn btn-custom mt-4 w-100">Add User</div>
              </div>
          </a>
      </div>
      <div class="col-lg-3 col-md-6">
          <a href="{% url 'update' %}" class="text-decoration-none">
              <div class="feature-container text-center p-4">
                  <i class="fas fa-user-edit feature-icon"></i>
                  <div class="feature-text">Update User</div>
                  <div class="btn btn-custom mt-4 w-100">Update User</div>
              </div>
          </a>
      </div>
      <div class="col-lg-3 col-md-6">
          <a href="{% url 'delete' %}" class="text-decoration-none">
              <div class="feature-container text-center p-4">
                  <i class="fas fa-user-times feature-icon"></i>
                  <div class="feature-text">Delete User</div>
                  <div class="btn btn-custom mt-4 w-100">Delete User</div>
              </div>
          </a>
      </div>
      <div class="col-lg-3 col-md-6">
          <a href="#" id="statsbutton" class="text-decoration-none">
              <div class="feature-container text-center p-4">
                  <i class="fas fa-chart-bar feature-icon"></i>
                  <div class="feature-text">See Statistics</div>
                  <div class="btn btn-custom mt-4 w-100">See Statistics</div>
              </div>
          </a>
      </div>
  </div>
</div>






    <div class="container mt-4" id="stats" style="display: none;">
  <h2>Patient Statistics</h2>

<!--        doughnut graph-->
        <div class="chart-container">
  <canvas id="bmiDoughnutChart"></canvas>
</div>


<!--        graph end-->

<!--        table start-->

  <table class="table table-striped">
    <thead>
      <tr>
        <th scope="col">Category</th>
        <th scope="col">Count</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Total Count of Patients</td>
        <td>{{ count }}</td>
      </tr>
      <tr>
        <td>Total Count of Males</td>
        <td>{{ male_count }}</td>
      </tr>
      <tr>
        <td>Total Count of Females</td>
        <td>{{ female_count }}</td>
      </tr>
      <tr>
        <td>Underweight</td>
        <td>{{ underweight_count }}</td>
      </tr>
      <tr>
        <td>Normal Weight</td>
        <td>{{ idealweight_count }}</td>
      </tr>
      <tr>
        <td>Overweight</td>
        <td>{{ overweight_count }}</td>
      </tr>
      <tr>
        <td>Obese Class I</td>
        <td>{{ obese_class1_count }}</td>
      </tr>
      <tr>
        <td>Obese Class II</td>
        <td>{{ obese_class2_count }}</td>
      </tr>
      <tr>
        <td>Obese Class III</td>
        <td>{{ obese_class3_count }}</td>
      </tr>
    </tbody>
  </table>
</div>
<!--    table end-->

<div class="text-center mt-4 mb-4">
    <h2>Graphical Analysis</h2>
</div>

<!-- Flex container for center alignment and padding -->
<div class="d-flex justify-content-center px-4">
    <div class="card" style="width: 90%; max-width: 900px;">
        <div class="card-body">
            <!-- Form starts -->
            <form method="post" action="{% url 'manager_graphs' %}">
                {% csrf_token %}
                <div class="row g-3"> <!-- Grid with gap -->
                    <!-- X-axis Selection -->
                    <div class="col-md-6">
                        <label for="x-axis-select" class="form-label">X - axis</label>
                        <select name="xaxis" id="x-axis-select" class="form-select" required>
                            <option value="">Select an option for X-axis</option>
                            <option value="age">Age</option>
                            <option value="gender">Gender</option>
                            <option value="height">Height</option>
                            <option value="weight">Weight</option>
                            <option value="blood_type">Blood Type</option>
                            <option value="blood_pressure">Blood Pressure</option>
                            <option value="oxygen_level">Oxygen Level</option>
                            <option value="heart_rate">Heart Rate</option>
                            <option value="blood_sugar">Blood Sugar</option>
                            <option value="cholesterol">Cholesterol</option>
                            <option value="body_temperature">Body Temperature</option>
                            <option value="bmi">BMI</option>
                            <option value="sleep_hours">Sleep Hours</option>
                            <option value="stress_level">Stress Level</option>
                        </select>
                    </div>

                    <!-- Y-axis Selection -->
                    <div class="col-md-6">
                        <label for="y-axis-select" class="form-label">Y - axis</label>
                        <select name="yaxis" id="y-axis-select" class="form-select" required>
                            <option value="">Select an option for Y-axis</option>
                            <option value="age">Age</option>
                            <option value="gender">Gender</option>
                            <option value="height">Height</option>
                            <option value="weight">Weight</option>
                            <option value="blood_type">Blood Type</option>
                            <option value="blood_pressure">Blood Pressure</option>
                            <option value="oxygen_level">Oxygen Level</option>
                            <option value="heart_rate">Heart Rate</option>
                            <option value="blood_sugar">Blood Sugar</option>
                            <option value="cholesterol">Cholesterol</option>
                            <option value="body_temperature">Body Temperature</option>
                            <option value="bmi">BMI</option>
                            <option value="sleep_hours">Sleep Hours</option>
                            <option value="stress_level">Stress Level</option>
                        </select>
                    </div>

                    <!-- Graph Type Selection -->
                    <div class="col-12">
                        <label for="graph-select" class="form-label">Graph Type</label>
                        <select name="graph" id="graph-select" class="form-select" required>
                            <option value="">Select a graph type</option>
                            <option value="line">Line Graph</option>
                            <option value="scatter">Scatter Plot</option>
                            <option value="bar">Bar Chart</option>
                        </select>
                    </div>
                </div>

                <!-- Submit Button -->
                <div class="d-grid gap-2 mt-4">
                    <button type="submit" class="btn btn-primary">Create Graph</button>
                </div>
            </form>
        </div>
    </div>
</div>






    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
  </body>

<script>
<!--count graph-->
document.addEventListener('DOMContentLoaded', function () {
    const ctx = document.getElementById('dbCountChart').getContext('2d');
    const dbCountChart = new Chart(ctx, {
        type: 'doughnut',
        data: {
            labels: ['Database 1', 'Database 2'],
            datasets: [{
                data: [{{ db1_count }}, {{ db2_count }}],
                 backgroundColor: [
                    '#FF8000',  // Orange
                    '#0000FF'   // Blue
                ],
                borderColor: [
                    '#FF8000',  // Orange border
                    '#0000FF'   // Blue border
                ],
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            cutoutPercentage: 70,
            plugins: {
                datalabels: {
                    color: '#FFF',
                    textAlign: 'center',
                    font: {
                        weight: 'bold',
                        size: 13
                    },
                    formatter: (value, ctx) => {
                        return ctx.chart.data.labels[ctx.dataIndex] + '\n' + value;
                    }
                },
                tooltip: {
                    callbacks: {
                        label: function(tooltipItem) {
                            return `${tooltipItem.label}: ${tooltipItem.raw}`;
                        }
                    }
                }
            }
        },
        plugins: [ChartDataLabels]
    });
});
<!--table-->
  document.addEventListener('DOMContentLoaded', function() {
    const ctx = document.getElementById('bmiDoughnutChart').getContext('2d');
    const bmiDoughnutChart = new Chart(ctx, {
      type: 'doughnut',
      data: {
        labels: [
          'Underweight',
          'Normal Weight',
          'Overweight',
          'Obese Class I',
          'Obese Class II',
          'Obese Class III'
        ],
        datasets: [{
          data: [/* Replace with your data */ {{underweight_count}}, {{idealweight_count}}, {{overweight_count}}, {{obese_class1_count}}, {{obese_class2_count}}, {{obese_class3_count}}],
          backgroundColor: [
            '#f8c291',
            '#6a89cc',
            '#82ccdd',
            '#f6b93b',
            '#e55039',
            '#4a69bd'
          ],
          hoverBackgroundColor: [
            '#f6d365',
            '#7d5fff',
            '#4bcffa',
            '#fbc7d4',
            '#ff6b81',
            '#34e7e4'
          ],
          borderColor: '#fff',
          borderWidth: 2
        }]
      },
      options: {
        responsive: true,
        legend: {
          position: 'bottom',
        },
        tooltips: {
          enabled: true
        },
        animation: {
          animateScale: true,
          animateRotate: true
        },
        onClick: function(event, elements) {
          if (elements.length > 0) {
            var index = elements[0]._index;
            var label = this.data.labels[index];
            var value = this.data.datasets[0].data[index];
            alert(`You clicked on: ${label} (Value: ${value})`);
          }
        }
      }
    });
  });

<!--stats-->
    document.getElementById('statsbutton').addEventListener('click', function(event) {
    // Prevent the default form submission which causes a page reload
    event.preventDefault();

    var div = document.getElementById('stats');
    div.style.display = div.style.display === 'none' ? 'block' : 'none';
  });
</script>

</html>