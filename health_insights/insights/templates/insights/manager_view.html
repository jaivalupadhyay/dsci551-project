<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bootstrap demo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    /* Add any additional styling you wish here */
    .chart-container {
      position: relative;
      height: 40vh;
      width: 40vw;
    }
  </style>

  <style>
    body {
      background-color: #f7f7f7;
    }
    .table-custom {
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
      background-color: #ffffff;
      border-radius: 8px;
      overflow: hidden;
    }
    .table-custom thead {
      background-color: #007bff;
      color: #ffffff;
    }
    .table-custom thead th {
      border: none;
    }
    .table-custom tbody tr:hover {
      background-color: #f2f2f2;
    }
    .table-custom tbody td {
      border-color: #e9ecef;
    }
    .container {
      padding-top: 30px;
    }
  </style>

      <style>
    #dbCountChart {
        padding: 0px;
        width: 100px;
    }
    .chart-container {
    padding: 0px;
   }
</style>

  </head>
  <body>

    <nav class="navbar bg-primary px-3" data-bs-theme="dark">
        <!-- Navbar content -->
        <div class="container-fluid">
            <a href="{% url 'home' %}" class="navbar-brand mb-0 h1">
                <span>Health Insights</span>
            </a>

        </div>

    </nav>

      <h1>Manager View</h1>

<!--          <h4>Database Counts</h4>-->
<!--    <p>Database 1: {{ db1_count }}</p>-->
<!--    <p>Database 2: {{ db2_count }}</p>-->
    <h4>Database Counts</h4>
    <div class="chart-container px-4" style="width:350px">
        <canvas id="dbCountChart"></canvas>
    </div>

<script>
document.addEventListener('DOMContentLoaded', function () {
    const ctx = document.getElementById('dbCountChart').getContext('2d');
    const dbCountChart = new Chart(ctx, {
        type: 'doughnut',
        data: {
            labels: ['Database 1', 'Database 2'],
            datasets: [{
                data: [{{ db1_count }}, {{ db2_count }}],
                 backgroundColor: [
                    '#FF8000',  // Orange
                    '#0000FF'   // Blue
                ],
                borderColor: [
                    '#FF8000',  // Orange border
                    '#0000FF'   // Blue border
                ],
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            cutoutPercentage: 70,
            plugins: {
                datalabels: {
                    color: '#000',
                    textAlign: 'center',
                    font: {
                        weight: 'bold',
                        size: 13
                    },
                    formatter: (value, ctx) => {
                        return ctx.chart.data.labels[ctx.dataIndex] + '\n' + value;
                    }
                },
                tooltip: {
                    callbacks: {
                        label: function(tooltipItem) {
                            return `${tooltipItem.label}: ${tooltipItem.raw}`;
                        }
                    }
                }
            }
        },
        plugins: [ChartDataLabels]
    });
});
</script>

<script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@0.7.0"></script>

    <ul>
        {% for patient in patients1 %}
            <li>ID: {{ patient.patient_id }}, Name: {{ patient.name }}, Weight: {{ patient.weight }} kg, Height: {{ patient.height }} cm</li>
        {% endfor %}
    </ul>
    <ul>
        {% for patient in patients2 %}
            <li>ID: {{ patient.patient_id }}, Name: {{ patient.name }}, Weight: {{ patient.weight }} kg, Height: {{ patient.height }} cm</li>
        {% endfor %}
    </ul>

      <ul>
     <a href="{% url 'add' %}" class="btn btn-primary" role="button">Add</a>
      </ul>

    <ul>
      <a href="{% url 'update' %}" class="btn btn-primary" role="button">Update</a>
      </ul>

    <ul>
      <a href="{% url 'delete' %}" class="btn btn-primary" role="button">Delete</a>
      </ul>

        <ul>
      <a href="" class="btn btn-primary" role="button" id="statsbutton">Stats</a>
      </ul>




    <div class="container mt-4" id="stats" style="display: none;">
  <h2>Patient Statistics</h2>

<!--        doughnut graph-->
        <div class="chart-container">
  <canvas id="bmiDoughnutChart"></canvas>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const ctx = document.getElementById('bmiDoughnutChart').getContext('2d');
    const bmiDoughnutChart = new Chart(ctx, {
      type: 'doughnut',
      data: {
        labels: [
          'Underweight',
          'Normal Weight',
          'Overweight',
          'Obese Class I',
          'Obese Class II',
          'Obese Class III'
        ],
        datasets: [{
          data: [/* Replace with your data */ 5, 10, 8, 3, 2, 1],
          backgroundColor: [
            '#f8c291',
            '#6a89cc',
            '#82ccdd',
            '#f6b93b',
            '#e55039',
            '#4a69bd'
          ],
          hoverBackgroundColor: [
            '#f6d365',
            '#7d5fff',
            '#4bcffa',
            '#fbc7d4',
            '#ff6b81',
            '#34e7e4'
          ],
          borderColor: '#fff',
          borderWidth: 2
        }]
      },
      options: {
        responsive: true,
        legend: {
          position: 'bottom',
        },
        tooltips: {
          enabled: true
        },
        animation: {
          animateScale: true,
          animateRotate: true
        },
        onClick: function(event, elements) {
          if (elements.length > 0) {
            var index = elements[0]._index;
            var label = this.data.labels[index];
            var value = this.data.datasets[0].data[index];
            alert(`You clicked on: ${label} (Value: ${value})`);
          }
        }
      }
    });
  });
</script>

<!--        graph end-->

<!--        table start-->

  <table class="table table-striped">
    <thead>
      <tr>
        <th scope="col">Category</th>
        <th scope="col">Count</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Total Count of Patients</td>
        <td>{{ count }}</td>
      </tr>
      <tr>
        <td>Total Count of Males</td>
        <td>{{ male_count }}</td>
      </tr>
      <tr>
        <td>Total Count of Females</td>
        <td>{{ female_count }}</td>
      </tr>
      <tr>
        <td>Underweight</td>
        <td>{{ underweight_count }}</td>
      </tr>
      <tr>
        <td>Normal Weight</td>
        <td>{{ idealweight_count }}</td>
      </tr>
      <tr>
        <td>Overweight</td>
        <td>{{ overweight_count }}</td>
      </tr>
      <tr>
        <td>Obese Class I</td>
        <td>{{ obese_class1_count }}</td>
      </tr>
      <tr>
        <td>Obese Class II</td>
        <td>{{ obese_class2_count }}</td>
      </tr>
      <tr>
        <td>Obese Class III</td>
        <td>{{ obese_class3_count }}</td>
      </tr>
    </tbody>
  </table>
</div>
<!--    table end-->

    <h2>Graphical Analysis</h2>

<!-- Flex container -->
<div class="d-flex justify-content-start p-4">

<form method="post">
    {% csrf_token %}
    <div class="form-group">
      <label for="x-axis-select">X - axis</label>
      <select name="xaxis" id="x-axis-select" class="form-control" required>
          <option value="">Select an option for X-axis</option>
          <option value="age">Age</option>
          <option value="gender">Gender</option>
          <option value="height">Height</option>
          <option value="weight">Weight</option>
          <option value="blood_type">Blood Type</option>
          <option value="blood_pressure">Blood Pressure</option>
          <option value="oxygen_level">Oxygen Level</option>
          <option value="heart_rate">Heart Rate</option>
          <option value="blood_sugar">Blood Sugar</option>
          <option value="cholesterol">Cholesterol</option>
          <option value="body_temperature">Body Temperature</option>
          <option value="bmi">BMI</option>
          <option value="sleep_hours">Sleep Hours</option>
          <option value="stress_level">Stress Level</option>
      </select>
  </div>

  <div class="form-group">
      <label for="y-axis-select">Y - axis</label>
      <select name="yaxis" id="y-axis-select" class="form-control" required>
          <option value="">Select an option for Y-axis</option>
          <option value="age">Age</option>
          <option value="gender">Gender</option>
          <option value="height">Height</option>
          <option value="weight">Weight</option>
          <option value="blood_type">Blood Type</option>
          <option value="blood_pressure">Blood Pressure</option>
          <option value="oxygen_level">Oxygen Level</option>
          <option value="heart_rate">Heart Rate</option>
          <option value="blood_sugar">Blood Sugar</option>
          <option value="cholesterol">Cholesterol</option>
          <option value="body_temperature">Body Temperature</option>
          <option value="bmi">BMI</option>
          <option value="sleep_hours">Sleep Hours</option>
          <option value="stress_level">Stress Level</option>
      </select>
  </div>

  <button type="submit" class="btn btn-primary">Create graph</button>
</form>




  <!-- ... Add more dropdowns here if needed ... -->

</div>



    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
<script>
    document.getElementById('statsbutton').addEventListener('click', function(event) {
    // Prevent the default form submission which causes a page reload
    event.preventDefault();

    var div = document.getElementById('stats');
    div.style.display = div.style.display === 'none' ? 'block' : 'none';
  });
</script>









    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
  </body>


</html>